{"version":3,"sources":["ie8andlower.js"],"names":["w","callMedia","applyMedia","respond","update","requestQueue","xmlHttp","xmlhttpmethod","XMLHttpRequest","e","ActiveXObject","ajax","url","callback","req","open","onreadystatechange","readyState","status","responseText","send","queue","regex","media","keyframes","urls","findStyles","only","minw","maxw","mediaQueriesSupported","matchMedia","matches","lastCall","resizeDefer","eminpx","doc","document","docElem","documentElement","mediastyles","rules","appendedEls","parsedSheets","resizeThrottle","head","getElementsByTagName","base","links","getEmValue","ret","div","createElement","body","originalHTMLFontSize","style","fontSize","originalBodyFontSize","fakeUsed","cssText","background","appendChild","insertBefore","firstChild","offsetWidth","removeChild","parseFloat","fromResize","name","docElemProp","currWidth","compatMode","styleBlocks","lastLink","length","now","Date","getTime","clearTimeout","setTimeout","i","hasOwnProperty","thisstyle","min","max","minnull","maxnull","em","indexOf","hasquery","push","j","parentNode","k","ss","css","join","type","nextSibling","styleSheet","createTextNode","translate","styles","href","qs","replace","match","ql","substring","lastIndexOf","repUrls","useMedia","fullq","thisq","eachq","eql","RegExp","$1","$2","split","makeRequests","thisRequest","shift","ripCSS","sheet","isCSS","rel","toLowerCase","rawCssText","test","location","host","protocol","addEventListener","attachEvent","this","undefined","bool","refNode","firstElementChild","fakeBody","id","q","innerHTML","addListener","localMatchMedia","hasMediaQueries","isListening","timeoutID","queries","handleChange","evt","il","mql","listeners","jl","call","index","listener","removeListener","splice"],"mappings":"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","file":"../ie8andlower.min.js","sourcesContent":["/*! Respond.js v1.4.0: min/max-width media query polyfill. (c) Scott Jehl. MIT Lic. j.mp/respondjs  */\n(function( w ){\n\n\t\"use strict\";\n\n\t//exposed namespace\n\tvar respond = {};\n\tw.respond = respond;\n\n\t//define update even in native-mq-supporting browsers, to avoid errors\n\trespond.update = function(){};\n\n\t//define ajax obj\n\tvar requestQueue = [],\n\t\txmlHttp = (function() {\n\t\t\tvar xmlhttpmethod = false;\n\t\t\ttry {\n\t\t\t\txmlhttpmethod = new w.XMLHttpRequest();\n\t\t\t}\n\t\t\tcatch( e ){\n\t\t\t\txmlhttpmethod = new w.ActiveXObject( \"Microsoft.XMLHTTP\" );\n\t\t\t}\n\t\t\treturn function(){\n\t\t\t\treturn xmlhttpmethod;\n\t\t\t};\n\t\t})(),\n\n\t\t//tweaked Ajax functions from Quirksmode\n\t\tajax = function( url, callback ) {\n\t\t\tvar req = xmlHttp();\n\t\t\tif (!req){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treq.open( \"GET\", url, true );\n\t\t\treq.onreadystatechange = function () {\n\t\t\t\tif ( req.readyState !== 4 || req.status !== 200 && req.status !== 304 ){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tcallback( req.responseText );\n\t\t\t};\n\t\t\tif ( req.readyState === 4 ){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treq.send( null );\n\t\t};\n\n\t//expose for testing\n\trespond.ajax = ajax;\n\trespond.queue = requestQueue;\n\n\t// expose for testing\n\trespond.regex = {\n\t\tmedia: /@media[^\\{]+\\{([^\\{\\}]*\\{[^\\}\\{]*\\})+/gi,\n\t\tkeyframes: /@(?:\\-(?:o|moz|webkit)\\-)?keyframes[^\\{]+\\{(?:[^\\{\\}]*\\{[^\\}\\{]*\\})+[^\\}]*\\}/gi,\n\t\turls: /(url\\()['\"]?([^\\/\\)'\"][^:\\)'\"]+)['\"]?(\\))/g,\n\t\tfindStyles: /@media *([^\\{]+)\\{([\\S\\s]+?)$/,\n\t\tonly: /(only\\s+)?([a-zA-Z]+)\\s?/,\n\t\tminw: /\\([\\s]*min\\-width\\s*:[\\s]*([\\s]*[0-9\\.]+)(px|em)[\\s]*\\)/,\n\t\tmaxw: /\\([\\s]*max\\-width\\s*:[\\s]*([\\s]*[0-9\\.]+)(px|em)[\\s]*\\)/\n\t};\n\n\t//expose media query support flag for external use\n\trespond.mediaQueriesSupported = w.matchMedia && w.matchMedia( \"only all\" ) !== null && w.matchMedia( \"only all\" ).matches;\n\n\t//if media queries are supported, exit here\n\tif( respond.mediaQueriesSupported ){\n\t\treturn;\n\t}\n\n\t//define vars\n\tvar doc = w.document,\n\t\tdocElem = doc.documentElement,\n\t\tmediastyles = [],\n\t\trules = [],\n\t\tappendedEls = [],\n\t\tparsedSheets = {},\n\t\tresizeThrottle = 30,\n\t\thead = doc.getElementsByTagName( \"head\" )[0] || docElem,\n\t\tbase = doc.getElementsByTagName( \"base\" )[0],\n\t\tlinks = head.getElementsByTagName( \"link\" ),\n\n\t\tlastCall,\n\t\tresizeDefer,\n\n\t\t//cached container for 1em value, populated the first time it's needed\n\t\teminpx,\n\n\t\t// returns the value of 1em in pixels\n\t\tgetEmValue = function() {\n\t\t\tvar ret,\n\t\t\t\tdiv = doc.createElement('div'),\n\t\t\t\tbody = doc.body,\n\t\t\t\toriginalHTMLFontSize = docElem.style.fontSize,\n\t\t\t\toriginalBodyFontSize = body && body.style.fontSize,\n\t\t\t\tfakeUsed = false;\n\n\t\t\tdiv.style.cssText = \"position:absolute;font-size:1em;width:1em\";\n\n\t\t\tif( !body ){\n\t\t\t\tbody = fakeUsed = doc.createElement( \"body\" );\n\t\t\t\tbody.style.background = \"none\";\n\t\t\t}\n\n\t\t\t// 1em in a media query is the value of the default font size of the browser\n\t\t\t// reset docElem and body to ensure the correct value is returned\n\t\t\tdocElem.style.fontSize = \"100%\";\n\t\t\tbody.style.fontSize = \"100%\";\n\n\t\t\tbody.appendChild( div );\n\n\t\t\tif( fakeUsed ){\n\t\t\t\tdocElem.insertBefore( body, docElem.firstChild );\n\t\t\t}\n\n\t\t\tret = div.offsetWidth;\n\n\t\t\tif( fakeUsed ){\n\t\t\t\tdocElem.removeChild( body );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tbody.removeChild( div );\n\t\t\t}\n\n\t\t\t// restore the original values\n\t\t\tdocElem.style.fontSize = originalHTMLFontSize;\n\t\t\tif( originalBodyFontSize ) {\n\t\t\t\tbody.style.fontSize = originalBodyFontSize;\n\t\t\t}\n\n\n\t\t\t//also update eminpx before returning\n\t\t\tret = eminpx = parseFloat(ret);\n\n\t\t\treturn ret;\n\t\t},\n\n\t\t//enable/disable styles\n\t\tapplyMedia = function( fromResize ){\n\t\t\tvar name = \"clientWidth\",\n\t\t\t\tdocElemProp = docElem[ name ],\n\t\t\t\tcurrWidth = doc.compatMode === \"CSS1Compat\" && docElemProp || doc.body[ name ] || docElemProp,\n\t\t\t\tstyleBlocks\t= {},\n\t\t\t\tlastLink = links[ links.length-1 ],\n\t\t\t\tnow = (new Date()).getTime();\n\n\t\t\t//throttle resize calls\n\t\t\tif( fromResize && lastCall && now - lastCall < resizeThrottle ){\n\t\t\t\tw.clearTimeout( resizeDefer );\n\t\t\t\tresizeDefer = w.setTimeout( applyMedia, resizeThrottle );\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlastCall = now;\n\t\t\t}\n\n\t\t\tfor( var i in mediastyles ){\n\t\t\t\tif( mediastyles.hasOwnProperty( i ) ){\n\t\t\t\t\tvar thisstyle = mediastyles[ i ],\n\t\t\t\t\t\tmin = thisstyle.minw,\n\t\t\t\t\t\tmax = thisstyle.maxw,\n\t\t\t\t\t\tminnull = min === null,\n\t\t\t\t\t\tmaxnull = max === null,\n\t\t\t\t\t\tem = \"em\";\n\n\t\t\t\t\tif( !!min ){\n\t\t\t\t\t\tmin = parseFloat( min ) * ( min.indexOf( em ) > -1 ? ( eminpx || getEmValue() ) : 1 );\n\t\t\t\t\t}\n\t\t\t\t\tif( !!max ){\n\t\t\t\t\t\tmax = parseFloat( max ) * ( max.indexOf( em ) > -1 ? ( eminpx || getEmValue() ) : 1 );\n\t\t\t\t\t}\n\n\t\t\t\t\t// if there's no media query at all (the () part), or min or max is not null, and if either is present, they're true\n\t\t\t\t\tif( !thisstyle.hasquery || ( !minnull || !maxnull ) && ( minnull || currWidth >= min ) && ( maxnull || currWidth <= max ) ){\n\t\t\t\t\t\tif( !styleBlocks[ thisstyle.media ] ){\n\t\t\t\t\t\t\tstyleBlocks[ thisstyle.media ] = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstyleBlocks[ thisstyle.media ].push( rules[ thisstyle.rules ] );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//remove any existing respond style element(s)\n\t\t\tfor( var j in appendedEls ){\n\t\t\t\tif( appendedEls.hasOwnProperty( j ) ){\n\t\t\t\t\tif( appendedEls[ j ] && appendedEls[ j ].parentNode === head ){\n\t\t\t\t\t\thead.removeChild( appendedEls[ j ] );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tappendedEls.length = 0;\n\n\t\t\t//inject active styles, grouped by media type\n\t\t\tfor( var k in styleBlocks ){\n\t\t\t\tif( styleBlocks.hasOwnProperty( k ) ){\n\t\t\t\t\tvar ss = doc.createElement( \"style\" ),\n\t\t\t\t\t\tcss = styleBlocks[ k ].join( \"\\n\" );\n\n\t\t\t\t\tss.type = \"text/css\";\n\t\t\t\t\tss.media = k;\n\n\t\t\t\t\t//originally, ss was appended to a documentFragment and sheets were appended in bulk.\n\t\t\t\t\t//this caused crashes in IE in a number of circumstances, such as when the HTML element had a bg image set, so appending beforehand seems best. Thanks to @dvelyk for the initial research on this one!\n\t\t\t\t\thead.insertBefore( ss, lastLink.nextSibling );\n\n\t\t\t\t\tif ( ss.styleSheet ){\n\t\t\t\t\t\tss.styleSheet.cssText = css;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tss.appendChild( doc.createTextNode( css ) );\n\t\t\t\t\t}\n\n\t\t\t\t\t//push to appendedEls to track for later removal\n\t\t\t\t\tappendedEls.push( ss );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t//find media blocks in css text, convert to style blocks\n\t\ttranslate = function( styles, href, media ){\n\t\t\tvar qs = styles.replace( respond.regex.keyframes, '' ).match( respond.regex.media ),\n\t\t\t\tql = qs && qs.length || 0;\n\n\t\t\t//try to get CSS path\n\t\t\thref = href.substring( 0, href.lastIndexOf( \"/\" ) );\n\n\t\t\tvar repUrls = function( css ){\n\t\t\t\t\treturn css.replace( respond.regex.urls, \"$1\" + href + \"$2$3\" );\n\t\t\t\t},\n\t\t\t\tuseMedia = !ql && media;\n\n\t\t\t//if path exists, tack on trailing slash\n\t\t\tif( href.length ){ href += \"/\"; }\n\n\t\t\t//if no internal queries exist, but media attr does, use that\n\t\t\t//note: this currently lacks support for situations where a media attr is specified on a link AND\n\t\t\t\t//its associated stylesheet has internal CSS media queries.\n\t\t\t\t//In those cases, the media attribute will currently be ignored.\n\t\t\tif( useMedia ){\n\t\t\t\tql = 1;\n\t\t\t}\n\n\t\t\tfor( var i = 0; i < ql; i++ ){\n\t\t\t\tvar fullq, thisq, eachq, eql;\n\n\t\t\t\t//media attr\n\t\t\t\tif( useMedia ){\n\t\t\t\t\tfullq = media;\n\t\t\t\t\trules.push( repUrls( styles ) );\n\t\t\t\t}\n\t\t\t\t//parse for styles\n\t\t\t\telse{\n\t\t\t\t\tfullq = qs[ i ].match( respond.regex.findStyles ) && RegExp.$1;\n\t\t\t\t\trules.push( RegExp.$2 && repUrls( RegExp.$2 ) );\n\t\t\t\t}\n\n\t\t\t\teachq = fullq.split( \",\" );\n\t\t\t\teql = eachq.length;\n\n\t\t\t\tfor( var j = 0; j < eql; j++ ){\n\t\t\t\t\tthisq = eachq[ j ];\n\t\t\t\t\tmediastyles.push( {\n\t\t\t\t\t\tmedia : thisq.split( \"(\" )[ 0 ].match( respond.regex.only ) && RegExp.$2 || \"all\",\n\t\t\t\t\t\trules : rules.length - 1,\n\t\t\t\t\t\thasquery : thisq.indexOf(\"(\") > -1,\n\t\t\t\t\t\tminw : thisq.match( respond.regex.minw ) && parseFloat( RegExp.$1 ) + ( RegExp.$2 || \"\" ),\n\t\t\t\t\t\tmaxw : thisq.match( respond.regex.maxw ) && parseFloat( RegExp.$1 ) + ( RegExp.$2 || \"\" )\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tapplyMedia();\n\t\t},\n\n\t\t//recurse through request queue, get css text\n\t\tmakeRequests = function(){\n\t\t\tif( requestQueue.length ){\n\t\t\t\tvar thisRequest = requestQueue.shift();\n\n\t\t\t\tajax( thisRequest.href, function( styles ){\n\t\t\t\t\ttranslate( styles, thisRequest.href, thisRequest.media );\n\t\t\t\t\tparsedSheets[ thisRequest.href ] = true;\n\n\t\t\t\t\t// by wrapping recursive function call in setTimeout\n\t\t\t\t\t// we prevent \"Stack overflow\" error in IE7\n\t\t\t\t\tw.setTimeout(function(){ makeRequests(); },0);\n\t\t\t\t} );\n\t\t\t}\n\t\t},\n\n\t\t//loop stylesheets, send text content to translate\n\t\tripCSS = function(){\n\n\t\t\tfor( var i = 0; i < links.length; i++ ){\n\t\t\t\tvar sheet = links[ i ],\n\t\t\t\thref = sheet.href,\n\t\t\t\tmedia = sheet.media,\n\t\t\t\tisCSS = sheet.rel && sheet.rel.toLowerCase() === \"stylesheet\";\n\n\t\t\t\t//only links plz and prevent re-parsing\n\t\t\t\tif( !!href && isCSS && !parsedSheets[ href ] ){\n\t\t\t\t\t// selectivizr exposes css through the rawCssText expando\n\t\t\t\t\tif (sheet.styleSheet && sheet.styleSheet.rawCssText) {\n\t\t\t\t\t\ttranslate( sheet.styleSheet.rawCssText, href, media );\n\t\t\t\t\t\tparsedSheets[ href ] = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif( (!/^([a-zA-Z:]*\\/\\/)/.test( href ) && !base) ||\n\t\t\t\t\t\t\thref.replace( RegExp.$1, \"\" ).split( \"/\" )[0] === w.location.host ){\n\t\t\t\t\t\t\t// IE7 doesn't handle urls that start with '//' for ajax request\n\t\t\t\t\t\t\t// manually add in the protocol\n\t\t\t\t\t\t\tif ( href.substring(0,2) === \"//\" ) { href = w.location.protocol + href; }\n\t\t\t\t\t\t\trequestQueue.push( {\n\t\t\t\t\t\t\t\thref: href,\n\t\t\t\t\t\t\t\tmedia: media\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tmakeRequests();\n\t\t};\n\n\t//translate CSS\n\tripCSS();\n\n\t//expose update for re-running respond later on\n\trespond.update = ripCSS;\n\n\t//expose getEmValue\n\trespond.getEmValue = getEmValue;\n\n\t//adjust on resize\n\tfunction callMedia(){\n\t\tapplyMedia( true );\n\t}\n\n\tif( w.addEventListener ){\n\t\tw.addEventListener( \"resize\", callMedia, false );\n\t}\n\telse if( w.attachEvent ){\n\t\tw.attachEvent( \"onresize\", callMedia );\n\t}\n})(this);\n\r\n/*! matchMedia() polyfill - Test a CSS media type/query in JS. Authors & copyright (c) 2012: Scott Jehl, Paul Irish, Nicholas Zakas. Dual MIT/BSD license */\n/*! NOTE: If you're already including a window.matchMedia polyfill via Modernizr or otherwise, you don't need this part */\n\n(function(w){\n\t\"use strict\";\n\tw.matchMedia = w.matchMedia || (function( doc, undefined ) {\n\n\t\tvar bool,\n\t\t\tdocElem = doc.documentElement,\n\t\t\trefNode = docElem.firstElementChild || docElem.firstChild,\n\t\t\t// fakeBody required for <FF4 when executed in <head>\n\t\t\tfakeBody = doc.createElement( \"body\" ),\n\t\t\tdiv = doc.createElement( \"div\" );\n\n\t\tdiv.id = \"mq-test-1\";\n\t\tdiv.style.cssText = \"position:absolute;top:-100em\";\n\t\tfakeBody.style.background = \"none\";\n\t\tfakeBody.appendChild(div);\n\n\t\treturn function(q){\n\n\t\t\tdiv.innerHTML = \"&shy;<style media=\\\"\" + q + \"\\\"> #mq-test-1 { width: 42px; }</style>\";\n\n\t\t\tdocElem.insertBefore( fakeBody, refNode );\n\t\t\tbool = div.offsetWidth === 42;\n\t\t\tdocElem.removeChild( fakeBody );\n\n\t\t\treturn {\n\t\t\t\tmatches: bool,\n\t\t\t\tmedia: q\n\t\t\t};\n\n\t\t};\n\n\t}( w.document ));\n}( this ));\n\r\n/*! matchMedia() polyfill addListener/removeListener extension. Author & copyright (c) 2012: Scott Jehl. Dual MIT/BSD license */\n(function( w ){\n\t\"use strict\";\n\t// Bail out for browsers that have addListener support\n\tif (w.matchMedia && w.matchMedia('all').addListener) {\n\t\treturn false;\n\t}\n\n\tvar localMatchMedia = w.matchMedia,\n\t\thasMediaQueries = localMatchMedia('only all').matches,\n\t\tisListening     = false,\n\t\ttimeoutID       = 0,    // setTimeout for debouncing 'handleChange'\n\t\tqueries         = [],   // Contains each 'mql' and associated 'listeners' if 'addListener' is used\n\t\thandleChange    = function(evt) {\n\t\t\t// Debounce\n\t\t\tw.clearTimeout(timeoutID);\n\n\t\t\ttimeoutID = w.setTimeout(function() {\n\t\t\t\tfor (var i = 0, il = queries.length; i < il; i++) {\n\t\t\t\t\tvar mql         = queries[i].mql,\n\t\t\t\t\t\tlisteners   = queries[i].listeners || [],\n\t\t\t\t\t\tmatches     = localMatchMedia(mql.media).matches;\n\n\t\t\t\t\t// Update mql.matches value and call listeners\n\t\t\t\t\t// Fire listeners only if transitioning to or from matched state\n\t\t\t\t\tif (matches !== mql.matches) {\n\t\t\t\t\t\tmql.matches = matches;\n\n\t\t\t\t\t\tfor (var j = 0, jl = listeners.length; j < jl; j++) {\n\t\t\t\t\t\t\tlisteners[j].call(w, mql);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, 30);\n\t\t};\n\n\tw.matchMedia = function(media) {\n\t\tvar mql         = localMatchMedia(media),\n\t\t\tlisteners   = [],\n\t\t\tindex       = 0;\n\n\t\tmql.addListener = function(listener) {\n\t\t\t// Changes would not occur to css media type so return now (Affects IE <= 8)\n\t\t\tif (!hasMediaQueries) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Set up 'resize' listener for browsers that support CSS3 media queries (Not for IE <= 8)\n\t\t\t// There should only ever be 1 resize listener running for performance\n\t\t\tif (!isListening) {\n\t\t\t\tisListening = true;\n\t\t\t\tw.addEventListener('resize', handleChange, true);\n\t\t\t}\n\n\t\t\t// Push object only if it has not been pushed already\n\t\t\tif (index === 0) {\n\t\t\t\tindex = queries.push({\n\t\t\t\t\tmql         : mql,\n\t\t\t\t\tlisteners   : listeners\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tlisteners.push(listener);\n\t\t};\n\n\t\tmql.removeListener = function(listener) {\n\t\t\tfor (var i = 0, il = listeners.length; i < il; i++){\n\t\t\t\tif (listeners[i] === listener){\n\t\t\t\t\tlisteners.splice(i, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\treturn mql;\n\t};\n}( this ));\n"]}